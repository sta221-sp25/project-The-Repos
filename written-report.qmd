---
title: "Written Report on Factors that Help Diagnose Autism"
author: "The Repos - Jeffrey Bohrer, Alexandra Green, Anna Zhang, Kevin Lee"
date: "March 20, 2025"
format: pdf
execute: 
  warning: false
  message: false
  echo: false
editor: visual
---

```{r}
#|echo: false
#|warning: false
#|message: false
#| label: load packages and data

library(tidyverse)
library(tidymodels)
library(patchwork)
library(knitr)

autism_ds <- read_csv("data/autism_ds.csv") %>%
  mutate(ethnicity = ifelse(ethnicity == "others", "Others", ethnicity))
```

## Exploratory data analysis

**Introduction**

Autism Spectrum Disorder (ASD) remains a highly prevalent condition despite modern strides made in medical technology. It is reported that nearly 2.2% of adults are affected by ASD, and growing awareness has led to an uptick in diagnoses, particularly in adults who went undiagnosed early in life (Hirota 2023). However, ASD screening tests for all age groups currently contain significant inaccuracies. For example, the most widely used toddler screening test, CHAT-R/FAs, was recently found to produce false negatives in 25% of cases. In contrast, the most commonly used adult autism screening test – the Autism-Spectrum Quotient (AQ) – was found to have limited predictive value in certain populations (Aishworiya 2023; Curnow 2023). Therefore, it has become critical to identify stronger predictors or explore underlying relationships to have more accurate tests and models to predict ASD in adults.

In this study, we will focus on identifying the features that most greatly affect the probability of being encouraged to pursue a diagnosis. The dataset being used will contain ten individual characteristics and ten behavioral questions, each of which has been associated with ASD diagnoses. Because ASD is difficult to identify and can significantly impair an individual's quality of life, understanding the relationship between demographics, certain behaviors, and their association with autism could encourage individuals to seek diagnosis and gain the self-understanding they need. These adults who receive a positive diagnosis can then access the necessary support and resources. We believe that individual characteristics such as gender and ethnicity, along with answers to questions assessing socialization abilities, are key predictors of autism.

The test scores were slightly right-skewed with no significant outliers, and despite the majority of test-takers not being encouraged to seek diagnosis, a significant proportion was. In the test, the potential ASD indicator of difficulty resuming work after a distraction was frequently noted. Within racial distributions, Latino participants had the highest proportion of high scores, White-Europeans were the most common, and certain groups had significantly higher IQRs, such as Black and Hispanic groups, compared to groups such as the Turkish and Middle Eastern. However, some ethnicities had fewer than 50 observations, limiting generalizability. Between men and women, we also noted minimal differences.

**Univariate EDA**

```{r}
#|echo: false
#|warning: false
#|message: false
summary(autism_ds$result)

autism_ds |>
  ggplot(aes(x = result)) +
  geom_bar() +
  scale_x_continuous(breaks = seq(0, 10, 1), 
                     labels = as.character(seq(0, 10, 1))) +
  labs(x = "Score",
       y = "Count",
       title = "Histogram of Scoring Result")

nrow(autism_ds[autism_ds$'Class/ASD' == 'YES', ])/nrow(autism_ds)
```

As we can see as a quick summary of our data, the variable we are most interested in – the final score of users – ranges from 0 to 10, which makes sense as there are 10 questions that can be answered either 'Yes' or 'No'. Generally, the scores are a bit right-skewed, with a single peak around 4 or 5 points. The mean is found to be 5.077 points, and the median is 5 points, which is relatively high given that a score of higher than 6 warrants further investigation into a diagnosis. However, as suspecting a diagnosis is reason to take a test in the first place, that is a reasonable reflection of the population taking this test. We then observe that roughly 30% of test takers are encouraged to seek a diagnosis, due to a score higher than 6. We also observe the IQR to be 4 points, as most test takers have a score between 3 and 7 points inclusive. This is a reasonable spread in the context of the potential values, and in this context, no outliers exist.

```{r}
#|echo: false
#|warning: false
#|message: false
autism_ds |>
  ggplot(aes(x = `Class/ASD`)) +
  geom_bar() +
  labs(x = "Test Result",
       y = "Count",
       title = "Distribution of Whether or not Result Indicative of Autism")
```

Additionally, here is a visual demonstration of the number of test takers receiving further encouragement to pursue a professional diagnosis of ASD. Though still significantly less than those not encouraged, a notable proportion of test takers were informed they had traits or behaviors indicative of autism.

```{r}
#|echo: false
#|warning: false
#|message: false
autism_ds |>
  ggplot(aes(x = ethnicity)) +
  geom_bar() +
  labs(x = "Ethnicity",
       y = "Count",
       title = "Distribution of Ethnicity in the Dataset") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

We observe here that the most common ethnicity was White-Europeans, with over 200 observations in our data set. Secondly and thirdly, we observe the Asian and Middle Eastern populations to be above 100 and slightly below 100 observations, respectively. All other ethnicities have less than 50 observations in our data set, meaning it may be more difficult to draw conclusions about these populations. We can now check and see how the percentages of being encouraged to seek a diagnosis differ by ethnicity:

```{r}
#|echo: false
#|warning: false
#|message: false
autism_ds %>%
  group_by(ethnicity) %>%
  summarize(yes_count = sum(`Class/ASD` == "YES"),
            total_count = n(),
            proportion_yes = yes_count / total_count) %>%
  ggplot(aes(x = ethnicity, y = proportion_yes)) +
  geom_col() +
  labs(x = "Ethnicity",
       y = "Proportion of Test Scores",
       title = "Proportion of Indicative Test Scores") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

As we can see here, the population with the highest proportion of test takers receiving a high test score was the Latino population, with close to half achieving higher than a 6. Since this is a comparably uncommon population in our data set, it does raise questions of whether it is indicative of the greater Latino population or merely due to the smaller sample size in our data set. Additionally, the White-European, Black, and Hispanic populations also demonstrate a greater proportion of high test scores. The variation in these proportions according to ethnicity warrants further exploration for how the distribution of test scores differs by ethnicity as well.

```{r}
#|echo: false
#|warning: false
#|message: false
autism_ds |>
  ggplot(aes(x = age)) +
  geom_bar() +
  labs(x = "Age",
       y = "Count",
       title = "Distribution of Age in the Dataset") +
  xlim(10, 75)
summary(autism_ds$age)

autism_ds |>
  ggplot(aes(x = `i_can_go_back_to_work_when_interrupted`)) +
  geom_bar() +
  labs(x = "Whether or not continue working after interrupted",
       y = "Count",
       title = "Distribution of the Ability to Return to Work after Interruption")
```

Generally, we observe the distribution of ages to possess a strong right-skewness, with a mean age of 30.22 and a median age of 27. There is a clear peak in the distribution roughly around early to mid 20's years of age. The ages possess a minimum of 17 up to a maximum age of 383, which is clearly a false observation that needs to be filtered from the data. The IQR is 13 years, which is a fairly small spread given the range of ages, as we observe that it seems the majority of test-takers are under 30 years old.

Additionally, as a brief glance at one of the ten questions on the test, we see that "the ability to continue working after an interruption" question had majority of test takers indicate that this was an area of difficulty, which acts as a potential indicator for ASD.

**Bivariate EDA**

```{r}
#|echo: false
#|warning: false
#|message: false
### Result score distributions by ethnicity
ggplot(autism_ds, 
       aes(x = result,
           y = ethnicity,
           fill = ethnicity)) +
  geom_boxplot() +
  labs(
    title = "Distribution of Scores Across Ethnicity",
    x = "Score",
    y = "Ethnicity"
  ) +
  theme_gray()

ggplot(autism_ds, 
       aes(x = result,
           y = relation,
           fill = relation)) +
  geom_violin(alpha = 0.5) +
  labs(
    title = "Distribution of Scores Across Person Filling Test",
    x = "Score",
    y = "Relation",
    fill
  ) +
  theme_gray()

Q1 <- ggplot(autism_ds, 
       aes(x = small_sounds,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q1",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()

Q2 <- ggplot(autism_ds, 
       aes(x = difficult_to_understand_char,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q2",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()

Q3 <- ggplot(autism_ds, 
       aes(x = ease_to_read_between_lines,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q3",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()

Q4 <- ggplot(autism_ds, 
       aes(x = focus_on_whole_picture,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q4",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()

Q5 <- ggplot(autism_ds, 
       aes(x = i_can_tell_if_someone_bored,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q5",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()

Q6 <- ggplot(autism_ds, 
       aes(x = i_can_multi_task,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q6",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()

Q7 <- ggplot(autism_ds, 
       aes(x = i_can_tell_feelings_from_faces,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q7",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()
Q8 <- ggplot(autism_ds, 
       aes(x = i_can_go_back_to_work_when_interrupted,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q8",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()
Q9 <- ggplot(autism_ds, 
       aes(x = i_like_to_collect_info_on_categories,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q9",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()

Q10 <- ggplot(autism_ds, 
       aes(x = i_find_it_hard_to_figure_out_others_intentions,
           y = gender,
           fill = gender)) +
  geom_violin() +
  labs(
    title = "Q10",
    x = "Score",
    y = "Gender"
  ) +
  theme_gray()

Q1
Q2
Q3
Q4
Q5
Q6
Q7
Q8
Q9
Q10

ggplot(autism_ds |> filter(age < 200), aes(
  x = age,
  y = result
)) +
  geom_point() +
  labs(
    title = "Points in Test vs. Age",
    x = "Age",
    y = "Score"
  ) +
  theme_gray()

```

Here we present several graphs displaying bivariate relationships. With our first set of box plots, we find further evidence for our previous suspicion that test score distributions differ by ethnicity. Although most ethnicities have a median within the range of roughly 3 to 6, some ethnicities, like the White-European, Black, and Hispanic populations, demonstrate a greater spread through their IQRs, while the Turkish, Middle Eastern, and Asian populations are much more concentrated around their medians. However, most ethnicities appear to have values almost entirely across the range of 0 to 10 in their test scores.

Interestingly, we can also observe how the relationship between the test taker and the subject of the questions may lead to different distributions of test scores. In the case when it is filled out by a relative or health care professional for example, the observed test score is 2 or greater, while in the case of the test taker being the subject or the parent of the subject, some still received a score of 0. This may reflect how personal biases or context affect truthfulness during the test.

Surprisingly, we can also observe minimal differences in how each gender answered the ten questions, with generally comparable distributions of 'Yes' and 'No'. This may be a point of further investigation as typically women tend to be underdiagnosed relative to men.

## Introduction and Data

## Methodology

```{r}
autism_ds <- autism_ds %>%
  mutate(highProb = if_else(result > 6, 1, 0))

reduced_model <- glm(highProb ~ 1, 
              data = autism_ds, family = "binomial")
ethnicity_model <- glm(highProb ~ ethnicity, 
              data = autism_ds, family = "binomial")

(deviance_reduced <- -2 * glance(reduced_model)$logLik)
(deviance_full <- -2 * glance(ethnicity_model)$logLik)
(G <- deviance_reduced - deviance_full)
pchisq(G, df = 9, lower.tail = FALSE)

tidy(ethnicity_model) |>
  kable(digits = 3)
```

```{r}
autism_ds <- autism_ds %>%
  mutate(highProb = if_else(result > 6, 1, 0))

reduced_model <- glm(highProb ~ 1, 
              data = autism_ds, family = "binomial")
relation_model <- glm(highProb ~ relation, 
              data = autism_ds, family = "binomial")

(deviance_reduced <- -2 * glance(reduced_model)$logLik)
(deviance_full <- -2 * glance(relation_model)$logLik)
(G <- deviance_reduced - deviance_full)
pchisq(G, df = 4, lower.tail = FALSE)

tidy(relation_model) |>
  kable(digits = 3)
```

```{r}
autism_ds <- autism_ds %>%
  mutate(highProb = if_else(result > 6, 1, 0))

reduced_model <- glm(highProb ~ 1, 
              data = autism_ds, family = "binomial")
q1_model <- glm(highProb ~ small_sounds, 
              data = autism_ds, family = "binomial")

(deviance_reduced <- -2 * glance(reduced_model)$logLik)
(deviance_full <- -2 * glance(q1_model)$logLik)
(G <- deviance_reduced - deviance_full)
pchisq(G, df = 1, lower.tail = FALSE)

tidy(q1_model) |>
  kable(digits = 3)
```

## Results

## References

Aishworiya, R., Kim, V., MA, Stewart, S., Hagerman, R., & Feldman, H. M. (2023). Meta-analysis of the Modified Checklist for Autism in Toddlers, Revised/Follow-up for Screening. *PEDIATRICS*, *151*(6). https://doi.org/10.1542/peds.2022-059393

Curnow, E., Utley, I., Rutherford, M., Johnston, L., & Maciver, D. (2023). Diagnostic assessment of autism in adults – current considerations in neurodevelopmentally informed professional learning with reference to ADOS-2. *Frontiers in Psychiatry*, *14*. https://doi.org/10.3389/fpsyt.2023.1258204

Hirota, T., & King, B. H. (2023). Autism spectrum Disorder. *JAMA*, *329*(2), 157. https://doi.org/10.1001/jama.2022.23661

::: callout-important
Before you submit, make sure your code chunks are turned off with `echo: false` and there are no warnings or messages with `warning: false` and `message: false` in the YAML.
:::
